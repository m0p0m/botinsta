<div class="dashboard">
  <% if (accounts.length > 0) { %>
    <div class="account-switcher">
      <form action="/switch-account" method="POST">
        <select name="username" onchange="this.form.submit()">
          <% accounts.forEach(account => { %>
            <option value="<%= account.username %>" <%= account.username === selectedAccount.username ? 'selected' : '' %>><%= account.username %></option>
          <% }) %>
        </select>
      </form>
    </div>

    <div class="profile-info">
      <img src="<%= profile.profile_pic_url %>" alt="Profile Picture">
      <div>
        <h2><%= profile.full_name %></h2>
        <p><%= profile.biography %></p>
      </div>
    </div>

    <div class="profile-stats">
      <div class="stat">
        <h3><%= profile.followers %></h3>
        <p>Followers</p>
      </div>
      <div class="stat">
        <h3><%= profile.following %></h3>
        <p>Following</p>
      </div>
      <div class="stat">
        <h3><%= profile.posts %></h3>
        <p>Posts</p>
      </div>
    </div>

    <div class="hashtag-form">
      <form action="/start" method="POST">
        <input type="hidden" name="username" value="<%= selectedAccount.username %>">
        <input type="text" name="hashtag" placeholder="Enter hashtag">
        <button type="submit">Start Liking</button>
      </form>
    </div>

    <div class="status-panel">
      <p>Status: <span id="status">Idle</span></p>
      <p id="message"></p>
    </div>
  <% } else { %>
    <p>No accounts added. Please add an account.</p>
  <% } %>

  <div class="add-account-form">
    <h2>Add Account</h2>
    <form action="/add-account" method="POST">
      <input type="text" name="username" placeholder="Username" required>
      <input type="password" name="password" placeholder="Password" required>
      <button type="submit">Add Account</button>
    </form>
  </div>
</div>

<script>
  const socket = new WebSocket('ws://' + window.location.host);

  socket.onmessage = (event) => {
    const data = JSON.parse(event.data);
    document.getElementById('status').textContent = data.status;
    document.getElementById('message').textContent = data.message;
  };
</script>
